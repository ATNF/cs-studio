<html>
<head>
<title>Data Browser</title>
</head>
<body>
<h2>Data Browser Export View</h2>
This view allows export of samples from the current plot
to files for further analysis in for example
<a href="#Excel">Excel</a>
or
<a href="#OpenOffice">Open Office.</a>
You can open it via the context menu of the
<a href=plot_window.html>plot window</a>.
<p>
<img src=export.png width=494 height=298/>
<ul>
<li>Start/End Time:<br>
    You can use the start and time time of the current plot,
    i.e. use the X-Axis range of that plot,
    or manually select times.
    You can either enter them in the YYYY/MM/DD HH:MM:SS format for year, month,
    day, hour, minute seconds, or use the 
    "Select" button to open a calendar-type dialog.
<li>Source:<br>
    You can export data from the current plot as it is currently kept in the
    Data Browser memory. This will include the 'live' samples which might not
    yet be in the archive. On the downside, the 'historic' data will be
    exported as shown in the plot, which is usually data that has been
    reduced for plotting purposes, and not the full-detailed archived data.
    <br>
    To export the original archive data, select "Raw Archive".
    Alternatively, you can also export data from the archive that has been
    averaged to the provided time interval. "00:01:00" as shown in the
    screenshot means: One averaged sample every minute (HH:MM:SS format).
<li>Output:<br>
    You typically want to export data in a spreadsheet-type format,
    including a column for additional severity/status information.
    In the spreadsheet, samples that did not receive a 'new' value, yet,
    will repeat their previous values in following rows in order to allow
    spreadsheet-type operations.
    Alternatively, you can export the PVs one by one into the file by
    not selecting the spreadsheet output, and you can also omit the severity/
    status column.
<li>Format:<br>
    The default format uses information that might have come with the
    PV from the control system. Alternatively, you can force "decimal"
    or "exponential" notation with a specific number of fractional digits.
<li>Filename:<br>
    Enter the filename into which the exported data is to be written,
    or "Browse" to get a file name dialog.
</ul>
Finally, the "Export" button starts the actual export.


<a name="Excel">
<h2>Using the Exported Data in MS Excel</h2>
</a>
The exported data files are in a text format with TAB-delimited columns
suitable for import into spreadsheet programs like Microsoft Excel.

Assume you chose a filename of "test.dat" on your Desktop, follow these
steps for import into Excel:
<ol>
<li>In Excel, use File/Open to open the file "test.dat".<br>
    You might have to select "Files of type: All Files (*.*)"
    in the file "Open" dialog to do this.
<li>A "Text Import Wizard" should appear, and the default settings
    should already be set to
   <ul>
   <li>"Delimited - Characters such as ... tabs ..."
   <li>"Delimiters: Tab"
   </ul>
<li>Excel will default to a less useful format for the first column,
    the "Time" column, and only show time down to minutes, omitting the
    seconds or microseconds.<br>
    Fix this by clicking on the "A" table header,
    i.e. selecting the whole first column; right-click to get
    the "Format Cells..." dialog, and enter a "Custom" format:
    <pre>  m/d/yy h:mm:ss.000</pre>
</ol>

When performing computations on the data, values marked "#N/A"
which have non numerical value because they represent a status or error
should be ignored by Excel.
<p>
For plots, the "X/Y scatter" plot type using time as the X
axis and the value column for the Y axis tends to work best.
<p>
Note that Excel is limited to about 65000 lines. If your data
file includes more lines, those will be lost in the import.
You can work around this by exporting a smaller time range
into separate files, or by exporting averaged data.
<p>
The value columns for averaged data will contain text like
"5 [0 ... 10]" to indicate that the average value for that time
was 5, with a minimum/maximum range of 0 to 10.
To perform computations in excel, it might be useful to
select the column and perform a text replacement of
"[*]" with "" (nothing) to delete the min/max info.

<a name="OpenOffice">
<h2>Using the Exported Data in Open Office</h2>
</a>
As long as the exported data file has a ".csv" suffix,
Open Office should open the file with an "import" dialog
similar to MS Excel, where you select "tab" delimited columns
as explained above.

File names ending in ".dat", ".txt" etc. might only
open in the Open Office word processor, so you have
to use the correct file suffix.

</body>
</html>