<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Cp1252"/>
    <link rel="stylesheet" href="../default.css" type="text/css" />
    <title>
     Access PV in Script
    </title>
  </head>
  <body>

    <h2>
      Access PV in Script
    </h2>
    
    <h3>pvArray</h3>
    <p>The input PVs for a script can be accessed in script via <b>pvArray</b> object. 
    The order of the input PVs in the configuation list is preserved in pvArray. 
    pvArray[0] is the first input pv. If you have <i>N</i> input PVs, <code>pvArray[N-1]</code> is the last input PV.       
    </p>
    
    <p>In script, you can read/write the input PVs and get the timestamp or severitis of the PVs via the utility APIs 
    provided in <a href ="PVUtil.html">PVUtil</a> 
    </p>
    
    <h3>Examples:</h3> 
    <h4>1. Get double value from PV</h4>
	<pre class="example_code">
importPackage(Packages.org.csstudio.opibuilder.scriptUtil);

var value = PVUtil.getDouble(pvArray[0]);
widgetController.getWidgetModel().setPropertyValue("start_angle", value);</pre>

    <h4>2. Get severity of PV</h4>
	<pre class="example_code">
importPackage(Packages.org.csstudio.opibuilder.scriptUtil);

var RED = ColorUtil.RED;
var ORANGE = ColorUtil.getColorFromRGB(255,255,0);
var GREEN = ColorUtil.getColorFromHSB(120.0,1.0,1.0);
var PINK = ColorUtil.PINK;

var severity = PVUtil.getSeverity(pvArray[0]);
var color;

switch(severity){
	case 0:  //OK
		color = GREEN;
		break;
	case 1:  //MAJOR
		color = RED;
		break;
	case 2:  //MINOR
		color = ORANGE;
		break;
	case -1:  //INVALID
	default:
		color = PINK;
}

widgetController.getWidgetModel().setPropertyValue("foreground_color",color);</pre>
 
  </body>
</html>
