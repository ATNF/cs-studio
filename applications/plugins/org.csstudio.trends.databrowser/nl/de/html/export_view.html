<?xml version='1.0' encoding='iso-8859-1'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de" dir="ltr">

<head>
	<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type" />
	<title>Data Browser</title>
</head>

<body>
<h2>Data Browser Export View</h2>
<p>
Diese View erlaubt das Exportieren von Daten aus dem aktuellen Plot
auf Dateien zur sp&auml;teren Analyse. Beispiel :

<a href="#Excel">Excel</a>
oder
<a href="#OpenOffice">Open Office.</a>
Man kann eine Datei &uuml;ber das Kontextmenu eines 
<a href="plot_window.html">Plot-Windows</a> &ouml;ffnen.

<img alt="" src="./export.png" width="494" height="298" />
</p>
<ul>
<li>Start/End Time:<br />
Man kann die Start- und End-Zeit des aktuellen Plots benutzen,
entweder den X-Achsen-Zeitbereich benutzen oder manuell Zeiten einstellen.
Man kann Zeiten entweder im Format YYYY/MM/DD HH:MM:SS (year, month,
day, hours, minutes, seconds) oder den "select"-Knopf benutzen, um einen
Kalender-Dialog zu &ouml;ffnen. </li>
<li>Source:<br />
    Man kann die Daten des aktuellen Plots, die gerade im Databrowser-Memory 
    gehalten werden, exportieren. Hier sind auch die 'life'-Daten eingeschlossen,
    die noch nicht archiviert sind. Der Nachteil ist, dass die historischen Daten 
    so exportiert werden, wie sie im Plot gezeigt werden, normalerweise in der Aufl&ouml;sung
    herabgesetzt und nicht mit allen Archiv-Details.
    <br />
    Um Original-Archivdaten zu exportieren, "Raw Archive" anklicken.
    Alternativ kann man auch Archivdaten exportieren, die &uuml;ber ein gegebenes Zeitinterval
    gemittelt sind. "00:01:00", wie im Beispiel, bedeutet: Ein gemittelter Datenwert pro
Minute (HH:MM:SS-Format). </li>
<li>Output:<br />
    Meist m&ouml;chte man Daten in ein Spreadsheet-Format exportieren, mit einer 
    zus&auml;tzlichen Spalte mit 'severity'/'status'-Information.
    Im Spreadsheet werden Datenfelder, f&uuml;r die es noch keinen 'neuen' Wert gibt,
    jeweils mit dem vorigen Wert aus der vorigen Zeile gef&uuml;llt.
    Andererseits kann man die PVs einen nach dem anderen in eine Datei exportieren,
    indem man 'spreadsheet output' nicht ausw&auml;hltt. Man kann auch die  severity/
status-Spalte weglassen. </li>
<li>Format:<br />
    Das vorgegebene Format entspricht dem Format des PV aus dem Controlsystem.
    Man kann das Format auf "decimal" oder "exponential" &auml;ndern,
    mit einer einstellbaren Anzahl von Nachkommastellen. </li>
<li>Filename:<br />
    Eingabe des Dateinamens der Datei, in welche die Export-Daten geschrieben werden sollen
oder "Browse", um eine Dateinamen-Dialogbox zu &ouml;ffnen. </li>
</ul>
<p>Schlie√ülich startet das Anklicken des "Export"-Knopfes den aktuellen Export.</p>

<!-- ??? <a name="Excel"> -->
<h2>Using the Exported Data in MS Excel</h2>
<p>
Die Export-Datendateien werden als Text-Dateien mit TAB als Delimiter erzeugt,
damit sie in Spreadsheet-Programmen vie Excel gut verwendbar sind.
<br />
Wenn man auf dem Desktop einen Dateinamen "test.dat" ausw&auml;hlt, sind folgende Schritte
f&uuml;r Datenimport in Excel auszf&uuml;hren.
</p>
<ol>
<li>In Excel File/Open, um die Datei "test.dat" zu &ouml;ffnen.<br />
    Vielleicht muss man "Files of type: All Files (*.*)"
im Datei-"&Ouml;ffnen"-Dialog einstellen. </li>
<li>Ein "Text Import Wizard" sollte aufklappen und die Einstellungen
sollten schon so gesetzt sein: </li>
<!-- ???   <ul> -->
   <li>"Delimited - Characters such as ... tabs ..."</li>
   <li>"Delimiters: Tab" </li>
<!-- ???   </ul> -->
<li>Excel benutzt ein wenig brauchbares Format f&uuml;r die erste Spalte, die "Zeit"-Spalte,
    in welchem nur Minuten, aber keine Sekunden und Millisekunden angezeigt werden.
    Man kan das Zeitformat &auml;ndern: Klicken auf den "A"-Tabellenkopf, d.h. die ganze 
    erste Spalte ausw&auml;hlen, dann Rechtsklick, um den "Format Cells..."-Dialog zu &ouml;ffnen
und dort ein "Custom"-Format eingeben: <pre>  m/d/yy h:mm:ss.000</pre>
</li>
</ol>

<p>
Wenn man Berechnungen mit den Daten durchf&uuml;hrt, sollten Werte, die mit "#N/A"
gekennzeichnet sind, die keinen numerischen Wert enthalten, weil sie Status- oder
Fehler-Information enthalten, von Excel ignoriert werden.
</p>
<p>
Wenn man Plots erzeugt, funktioniert der "X/Y scatter"-Plot
mit der Zeit-Spalte auf der X-Achse und der Werte-Spalte auf der Y-Achse
am besten.
</p>
<p>
Achtung: Die Excel-Zeilenanzahl ist auf 65000 limitiert.
Wenn eine Datendatei mehr Zeilen enth&auml;lt, gehen diese beim Import verloren.
Man kann dies Problem umschiffen, indem man die Daten mit kleineren Zeitfenstern 
in mehrere Dateien exportiert oder indem man Mittelwertdaten exportiert.
</p>
<p>
Die Werte-Spalten f&uuml;r Mittelwert-Daten enthalten Text wie "5 [0 ... 10]",
womit dargestellet wird, dass der Mittelwert f&uuml;r das Intervall 5 ist und der
Minimum/Maximum-Bereich von 0 bis 10 geht.
Wenn man Berechnungen mit Mittelwert-Daten durchf&uuml;hren will, kann man vorher
die Spalte ausw&auml;hlen und eine Text-Ersetzung von "[*]" nach "" (nichts) durchf&uuml;hren
um die Min/Max-Info zu l&ouml;schen.
</p>
<!-- ??? <a name="OpenOffice"> -->
<h2>Using the Exported Data in Open Office</h2>
<!-- </a> -->
<p>
Wenn die exportierte Datendatei die Dateierweiterung ".csv" hat, 
&ouml;ffnet Open Office die Datei mit einem "Import"-Dialog &auml;hnlich wie Excel.
Man kann Spalten ausw&auml;hlen, wie oben beschrieben.
</p>
<p>
Dateinamen, die mit ".dat", ".txt" etc. enden, &ouml;ffnen den Open-Office-Wordprozessor,
deswegen sollte man das richtige Suffix benutzen.
</p>
</body>
</html>